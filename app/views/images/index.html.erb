<!-- <h3>Welcome to Gallery.Here you can add and manage photos </h3><br> -->


<div class="panel panel-info">
      <div class="panel-heading">Welcome to Gallery</div>
      <div class="panel-body">
      	<div class="form-group"> 
      		<button type="button" class= "btn btn-default" data-toggle="modal" data-target="#myModal">Add Photo</button>
      	</div>
      	<div class="container">
	      	<div class="row">
	      		<% @photos.each do |photo| %>
	    			<div class="col">
	    				<h3><%= photo.name %></h3>
	      			<%= image_tag(photo.image_url, :size => "400x200")  if photo %> 
	    			</div>
	    			<div class="form-group">
	    				<button type="button" class="btn btn-primary btn-sm photo_edit" id="<%= photo.id %>">Edit</button>
	    				<%= link_to 'Destroy', image_path(photo.id),
            		data: {:confirm => 'Are you sure?'}, :method => :delete, class: "btn btn-danger btn-sm" %>
	    			</div>
	    			<% end if @photos %>	
	      	</div>
	      </div>	
</div>






<!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Add Photo</h4>
        </div>
        <div class="modal-body">
          <%= form_for :photo, url: images_path, method: :post, html:{:multipart => true, id: "photo_new_form"} do |f| %>
			  <div class="form-group">
			    <%= f.label :name, "Name"%>
			    <%= f.text_field :name, class: "form-control" %>
			  </div>
			  <div class="form-group">
			    <%= f.label :select_file, "Choose file" %>
			    <%= f.file_field :image_url %>
			  </div>
			  <!-- <button type="submit" class="btn btn-default">Submit</button> -->
        </div>
        <div class="modal-footer">
        	 <%= f.submit "Submit", class: "btn btn-primary" %>
          <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
        </div>
        <% end %>
      </div>
    </div>
  </div>


   <div class="modal fade" id="editModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Edit Photo</h4>
        </div>
        <div class="modal-body">
          <%= form_for :photo, url: images_path, method: :put, html:{:multipart => true, id: "photo_edit_form"} do |f| %>
			  <div class="form-group">
			    <%= f.label :name, "Name"%>
			    <%= f.text_field :name, class: "form-control", id: "edit_image_name" %>
			  </div>
			  <div class="form-group">
			    <%= f.label :select_file, "Choose file" %>
			    <%= f.file_field :image_url %>
			  </div>
			  <!-- <button type="submit" class="btn btn-default">Submit</button> -->
        </div>
        <div class="modal-footer">
        	 <%= f.submit "Submit", class: "btn btn-primary" %>
          <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
        </div>
        <% end %>
      </div>
    </div>
  </div>

  <script type="text/javascript">
  	$(".photo_edit").click(function(){
		    $('#editModal').modal('show');
		     $('#editModal').on('hidden.bs.modal', function () {
	            $(this).find('form').trigger('reset');
	        })
		    	var photo_id= $(this).attr('id');
	  		  $.ajax({
	                 	url: "/images/get_image_detail",
	                 	type: "GET",
	                  data: { id: photo_id },
	                  success: function(resp){ 
	                       $(".modal-body #edit_image_name").val(resp.photo_name);
	                  }
	        });

		}); 

  </script>
  